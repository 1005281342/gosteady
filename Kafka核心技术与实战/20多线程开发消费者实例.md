## 多线程方案

1. 消费者程序启动多个线程，每个线程维护专属的Kafka Consumer实例，负责完整的消息获取、消息处理流程。
   - 优点：实现简单；线程相互独立，省去了线程间交互安全保障的开销；很容易实现分区内消息的消费顺序。
   - 缺点：占用更多的内存、TCP链接资源；组内分区过多，对于少量机器消费场景下，会造成多余线程无法分配到任何分区而浪费系统资源；如果消息处理逻辑耗费时间过长，就很容易引起ReBalance，导致消费停止。
2. 消费者程序使用单或多线程获取消息，同时创建多个消费线程（线程池）执行消息处理逻辑。
   - 优点：高伸缩性，可以更好的利用系统资源。
   - 缺点：实现复杂；消息获取和消息处理过程分离，难以保证分区内消息消费顺序；消息链路被拉长，导致正确提交位移变得困难，容易引起重复消费。