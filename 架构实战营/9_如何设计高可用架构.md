## 高可用复杂度模型

![](9_如何设计高可用架构.assets/image-20220829235245126.png)

### 鸡蛋篮子理论第三法则 -- 冗余法则

冗余法则：**不要把所有鸡蛋装在一个篮子，放到多个篮子**

## 计算高可用

### 任务分配

![](9_如何设计高可用架构.assets/image-20220829235927519.png)

#### 计算高可用任务分配架构设计关键点

![](9_如何设计高可用架构.assets/image-20220830000042343.png)

#### 计算高可用任务分配案例

下图中3个案例都是高性能架构

![](9_如何设计高可用架构.assets/image-20220830000217605.png)

图2也是高可用架构，nginx内部有状态检测。图1、3不是高可用架构。

### 任务分解

![](9_如何设计高可用架构.assets/image-20220830000822961.png)

#### 计算高可用任务分解架构设计关键点

![](9_如何设计高可用架构.assets/image-20220830000948167.png)

#### 计算高可用任务分解案例 -- 微信服务拆分

![](9_如何设计高可用架构.assets/image-20220830004523250.png)

## 存储高可用

### 存储高可用复杂度模型

![](9_如何设计高可用架构.assets/image-20220902001707851.png)

### 数据复制格式

#### 复制命令

![](9_如何设计高可用架构.assets/image-20220902002005274.png)

比如命令类似于time.Now()取当前时间戳，被复制到其他服务器后产生的结果不同。

#### 复制数据

![](9_如何设计高可用架构.assets/image-20220902002044239.png)

#### 复制文件（数据块）

![](9_如何设计高可用架构.assets/image-20220902002130495.png)

### 数据复制方式 

#### 同步复制

<img src="9_如何设计高可用架构.assets/image-20220902002233851.png" style="zoom:50%;" />

#### 异步复制

<img src="9_如何设计高可用架构.assets/image-20220902002331306.png" style="zoom:50%;" />

#### 半同步复制

<img src="9_如何设计高可用架构.assets/image-20220902002427293.png" style="zoom:50%;" />

#### 多数复制

<img src="9_如何设计高可用架构.assets/image-20220902002501879.png" style="zoom:50%;" />

### 高可用存储复制案例

![](9_如何设计高可用架构.assets/image-20220902002618352.png)

### 可用状态决策

#### 独裁式

![](9_如何设计高可用架构.assets/image-20220903010002049.png)

#### 协商式

![](9_如何设计高可用架构.assets/image-20220903010119405.png)

#### 民主式/选举式

![](9_如何设计高可用架构.assets/image-20220903010308855.png)

## Q&A

### 为什么高性能架构分为单机高性能和集群高性能，为何高可用架构没有单机高可用？

高可用需要冗余，普通的PC机、服务器单机无法做到高可用。

### 鸡蛋篮子理论

可扩展 -- 拆分

高性能 -- 叠加

高可用 -- 冗余

